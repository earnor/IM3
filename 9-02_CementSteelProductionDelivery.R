# *------------------------------------------------------------------
# | PROBLEM NUMBER: 9.2
# | PROBLEM NAME: Cement Production and Shipment
# | UPDATE: AE     
# | DESCRIPTION: This program optimises a Network using the simplex
# |              algorithm. The network, based of nodes and links,
# |              has a certain capacity, which is found in part C.
# |              The optimal way to transport 700 truckloads over the
# |              network is the task of question A, and the cheapest 
# |              route is found in question B.
# | 
# | KEYWORDS: Network, optimisation, capapcity, simplex, cost, 
# |           cement, shipment
# *------------------------------------------------------------------

### ------------------DATA AND PACKAGE IMPORT-----------------
library(linprog)
library(lpSolve)

setwd("Y:/common/IBI/03-Employees Folders/Martani/IM3 Script - Workspace/Exercises/R-files/Updated")
data <- read.csv("9-02_CementSteelProductionDelivery_csvData.csv"
                 ,header=TRUE,sep=";") 
attach(data)

### ------------------VARIABLE DEFINITION---------------------

# The data frame "data" includes
# Origin,         the origin plant of the material
# Destination,    the destination construction site
# Cost Cement,    the cost of transporting cement
# Cost Steel,     the cost of transporting steel


### ---------------VARIABLE INPUT-------------------
# Based on the following objective function and constraints we 
# minimise costs. We set up the objective function for all 
# combinations of production plants,construction sites and material 
# type. First 3 variables account for the production of cement at 
# plants A, B and C respectively, and the next three for the 
# production of steel in same order. The next 6 variables are for the
# cement delivery from Plant A to construction sites 1-6, then from
# Plant B to sites 1-6 and Plant C to 1-6.
# Variables 25-42 then do the same for steel delivery
# Z = 170*x.1 + 170*x.2 + 180*x.3 + 180*x.4 +  185*x.5 +  185*x.6 
#   + 35*x.7  +  12*x.8 +   9*x.9 + 30*x.10 +  13*x.11 +  42*x.12 
#   + 27*x.13 +  9*x.14 + 12*x.15 +  9*x.16 +  26*x.17 +  95*x.18
#   + 26*x.19 +  7*x.20 +  9*x.21 + 12*x.22 +  11*x.23 +  23*x.24
#   + 45*x.25 + 42*x.26 + 20*x.27 + 37*x.28 +  26*x.29 +  54*x.30 
#   + 29*x.31 +  9*x.32 + 13*x.33 +  9*x.34 +  28*x.35 +  99*x.36
#   + 41*x.37 + 14*x.38 + 17*x.39 + 13*x.40 +  31*x.41 + 104*x.42

# The objective function is minimised.

# Plant A can be operated at 20 hours a day and produce cement at 130
# units per day or steel at 140 units a day. Plant B has rates of 130
# and 160 in a 15 hour day and Plant C 130 and 160 units in 20 hours.

# We set the functional constraints 1-3 accordingly, 

#     1/140 * x.1 + 1/130 * x.4 <= 20
#     1/130 * x.2 + 1/160 * x.5 <= 15
#     1/160 * x.3 + 1/170 * x.6 <= 20

# As all produce of each plant must be delivered, we let all 
# movements from a single plant equal the amount produced at the same
# plant. The following supply constraints 4-9 are set

#    x.7 +  x.8 +  x.9 + x.10 + x.11 + x.12 - x.1 = 0 # Cement @ Pl A
#   x.13 + x.14 + x.15 + x.16 + x.17 + x.18 - x.2 = 0 # Cement @ Pl B
#   x.19 + x.20 + x.21 + x.22 + x.23 + x.24 - x.3 = 0 # Cement @ Pl C
#   x.25 + x.26 + x.27 + x.28 + x.29 + x.30 - x.4 = 0 #  Steel @ Pl A
#   x.31 + x.32 + x.33 + x.34 + x.35 + x.36 - x.5 = 0 #  Steel @ Pl B
#   x.37 + x.38 + x.39 + x.40 + x.41 + x.42 - x.6 = 0 #  Steel @ Pl C

# We also want the demands from all construction sites to be met 
# exactly. The demand is given in table in exercise.
# The following demand constraints 10-21 are set:

#      x.7 + x.13 + x.19 = 500    # Cement to construction site 1
#      x.8 + x.14 + x.20 = 750    # Cement to construction site 2
#      x.9 + x.15 + x.21 = 400    # Cement to construction site 3
#     x.10 + x.16 + x.22 = 250    # Cement to construction site 4
#     x.11 + x.17 + x.23 = 950    # Cement to construction site 5
#     x.12 + x.18 + x.24 = 850    # Cement to construction site 6

#     x.25 + x.31 + x.37 = 100    # Steel to construction site 1
#     x.26 + x.32 + x.38 = 100    # Steel to construction site 2
#     x.27 + x.33 + x.39 = 0      # Steel to construction site 3
#     x.28 + x.34 + x.40 = 50     # Steel to construction site 4
#     x.29 + x.35 + x.41 = 200    # Steel to construction site 5
#     x.30 + x.36 + x.42 = 100    # Steel to construction site 6

# The variables x.1 - x.42 should be limited to positive integers.
# Constraints 22-63 are non-negativity constraints :    
#   x.1,...,x.42 >= 0



### ---------------PROGRAM OUTPUT-------------------

# Objective function
Z    <- c(c(170,170,180,180,185,185)
          , as.vector(data$Cost.Cement)
          , as.vector(data$Cost.Steel))
Z

n  <- length(Z)   # amount of x-variables.

# Functionality constraints
f.1  <- c(1/140, 0, 0, 1/130, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0)
g.1  <- c(20)
f.2  <- c( 0, 1/130, 0, 0, 1/160, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0)
g.2  <- c(15)
f.3  <- c( 0, 0, 1/160, 0, 0, 1/170
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0)
g.3  <- c(20)

# Supply Constraints
f.4  <- c(-1, 0, 0, 0, 0, 0
          , 1, 1, 1, 1, 1, 1
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0
          , 0, 0, 0, 0, 0, 0)
g.4  <- c(0)
f.5  <- c( 0,-1, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 1, 1, 1, 1, 1, 1
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0)
g.5  <- c(0)
f.6  <- c( 0, 0,-1, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 1, 1, 1, 1, 1, 1
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0)
g.6  <- c(0)
f.7  <- c( 0, 0, 0,-1, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 1, 1, 1, 1, 1, 1
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0)
g.7  <- c(0)
f.8  <- c( 0, 0, 0, 0,-1, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 1, 1, 1, 1, 1, 1
           , 0, 0, 0, 0, 0, 0)
g.8  <- c(0)
f.9  <- c( 0, 0, 0, 0, 0,-1
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 0, 0, 0, 0, 0, 0
           , 1, 1, 1, 1, 1, 1)
g.9  <- c(0)                 

# Demand Constraints
# for cement
f.10  <- c( 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)                        
g.10  <- c(500)
f.11  <- c( 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.11  <- c(750)
f.12  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)          
g.12  <- c(400)
f.13  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.13  <- c(250)
f.14  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.14  <- c(950)
f.15  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.15  <- c(850)
f.16  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0)                        
g.16  <- c(100)
f.17  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0)  
g.17  <- c(100)
f.18  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 1, 0, 0, 0)          
g.18  <- c(0)
f.19  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 1, 0, 0)  
g.19  <- c(50)
f.20  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 1, 0)  
g.20  <- c(200)
f.21  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 1)  
g.21  <- c(100)


# Non-negativity

f.22  <- c( 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.22  <- c(0)
f.23  <- c( 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.23  <- c(0)
f.24  <- c( 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.24  <- c(0)
f.25  <- c( 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.25  <- c(0)
f.26  <- c( 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.26  <- c(0)
f.27  <- c( 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.27  <- c(0)
f.28  <- c( 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.28  <- c(0)
f.29  <- c( 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.29  <- c(0)
f.30  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.30  <- c(0)
f.31  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.31  <- c(0)
f.32  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.32  <- c(0)
f.33  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.33  <- c(0)
f.34  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.34  <- c(0)
f.35  <- c( 0, 0, 0, 0, 0, 0
            
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.35  <- c(0)
f.36  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.36  <- c(0)
f.37  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.37  <- c(0)
f.38  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.38  <- c(0)
f.39  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.39  <- c(0)
f.40  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.40  <- c(0)
f.41  <- c( 0, 0, 0, 0, 0, 0
            
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.41  <- c(0)
f.42  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.42  <- c(0)
f.43  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.43  <- c(0)
f.44  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.44  <- c(0)
f.45  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.45  <- c(0)
f.46  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.46  <- c(0)
f.47  <- c( 0, 0, 0, 0, 0, 0
            
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.47  <- c(0)
f.48  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.48  <- c(0)
f.49  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.49  <- c(0)
f.50  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.50  <- c(0)
f.51  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.51  <- c(0)
f.52  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.52  <- c(0)
f.53  <- c( 0, 0, 0, 0, 0, 0
            
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.53  <- c(0)
f.54  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.54  <- c(0)
f.55  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0
            , 0, 0, 0, 0, 0, 0)  
g.55  <- c(0)
f.56  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0
            , 0, 0, 0, 0, 0, 0)  
g.56  <- c(0)
f.57  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1
            , 0, 0, 0, 0, 0, 0)  
g.57  <- c(0)
f.58  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 1, 0, 0, 0, 0, 0)  
g.58  <- c(0)
f.59  <- c( 0, 0, 0, 0, 0, 0
            
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 1, 0, 0, 0, 0)  
g.59  <- c(0)
f.60  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 1, 0, 0, 0)  
g.60  <- c(0)
f.61  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 1, 0, 0)  
g.61  <- c(0)
f.62  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 1, 0)  
g.62  <- c(0)
f.63  <- c( 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 0
            , 0, 0, 0, 0, 0, 1)  
g.63  <- c(0)

# As all variables should be integers, we define int

int <- 1:n

# For our constraints:

# Manually the number of constraints are typed in
c.l <- 3  # For less-than-or-equal-to constraints
c.m <- 42  # For more-than-or-equal-to constraints
c.e <- 18 # For equal-to constraints



A.l <- matrix(c(f.1,f.2,f.3),nrow=c.l,ncol=n, byrow=TRUE) 
b.l <- matrix(c(g.1,g.2,g.3),nrow=c.l,ncol=1, byrow=TRUE)
A.m <- matrix(c(   f.22,f.23,f.24,f.25,f.26,f.27
                   ,f.28,f.29,f.30,f.31,f.32,f.33
                   ,f.34,f.35,f.36,f.37,f.38,f.39
                   ,f.40,f.41,f.42,f.43,f.44,f.45
                   ,f.46,f.47,f.48,f.49,f.50,f.51
                   ,f.52,f.53,f.54,f.55,f.56,f.57
                   ,f.58,f.59,f.60,f.61,f.62,f.63)
              ,nrow=c.m,ncol=n, byrow=TRUE)
b.m <- matrix(c(  g.22,g.23,g.24,g.25,g.26,g.27
                  ,g.28,g.29,g.30,g.31,g.32,g.33
                  ,g.34,g.35,g.36,g.37,g.38,g.39
                  ,g.40,g.41,g.42,g.43,g.44,g.45
                  ,g.46,g.47,g.48,g.49,g.50,g.51
                  ,g.52,g.53,g.54,g.55,g.56,g.57
                  ,g.58,g.59,g.60,g.61,g.62,g.63)
              ,nrow=c.m,ncol=1, byrow=TRUE)
A.e <- matrix(c(  f.4, f.5, f.6, f.7, f.8, f.9
                  ,f.10,f.11,f.12,f.13,f.14,f.15
                  ,f.16,f.17,f.18,f.19,f.20,f.21)
              ,nrow=c.e,ncol=n, byrow=TRUE)
b.e <- matrix(c(  g.4, g.5, g.6, g.7, g.8, g.9
                  ,g.10,g.11,g.12,g.13,g.14,g.15
                  ,g.16,g.17,g.18,g.19,g.20,g.21)
              ,nrow=c.e,ncol=1, byrow=TRUE)

A <- rbind(A.l,A.m,A.e)
b <- rbind(b.l,b.m,b.e)

const.dir <- c(rep("<=",c.l),rep(">=",c.m),rep("=",c.e))

### ------------------CALCULATIONS-------------------


results <- lp (direction = "min", objective.in=Z, const.mat = A, 
               const.dir, const.rhs=b,
               int.vec = int, all.int=FALSE, all.bin=FALSE,
               num.bin.solns=1, use.rw=FALSE)

cost <- results$solution*Z

# Cost due to transportation is summed up in 
result <- cbind(data
                , results$solution[7:24], cost[7:24]
                , results$solution[25:42], cost[25:42])

#
result
# Cost due to production is :
sum(cost[1:6])
results

### --------------------PLOT--------------------

### ------------------PLOT END-------------------

# END
