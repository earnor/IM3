# *----------------------------------------------------------------
# | PROBLEM NUMBER: 10.3
# | PROBLEM NAME: Snow Removal Program
# | UPDATE: AE     
# | DESCRIPTION: A continuation of problem 8.3 considers an 
# |              optimal program with consideration of reducing 
# |              costs and maximising the contaminant removal in
# |              the disposed snow.
# | 
# | KEYWORDS: Cost, snow, removal, optimisation, contaminant,  
# |           multiple, objectives
# *-----------------------------------------------------------------

# Note: To run this program, you must have installed the packages 
#       'linprog' and 'lpSolve'.
#       The running of this program takes longer than usual.

# Question A is the same as problem 8.3, except the cost has been
# adapted,

### ------------------DATA AND PACKAGE IMPORT-----------------
library(linprog)
library(lpSolve)

### ------------------VARIABLE DEFINITION---------------------

# Z is a vector of coefficients of the objective function.
# f is a vector of left side of functional constraints, with indices 
# from 1
# g is the corresponding right side of the constraint

# A.l is the collection of all constraints' left sides (f) that have 
# a less than or equal to sign.
# b.l is the corresponding right side (g).
# A and b also carry the indices .m for constraints that has a more 
# than or equal to sign, and .e for one that has an equal sign.
# The constraint is then constructed using A*x=b where x is a vector
# of variables

### ---------------VARIABLE INPUT-------------------
# Based on the following objective function and constraints to
# minimise costs.
# We set up the objective function for all 4 generator types and
# every year.
# Z =
# (35*(153*( 3.4*x.1,1+ 1.4*x.1,2+ 4.9*x.1,3+ 7.4*x.1,4+ 9.3*x.1,5)
#     +152*( 2.4*x.2,1+ 2.1*x.2,2+ 8.3*x.2,3+ 9.1*x.2,4+ 8.8*x.2,5)  
#     +154*( 1.4*x.3,1+ 2.9*x.3,2+ 3.7*x.3,3+ 9.4*x.3,4+ 8.6*x.3,5)
#     +138*( 2.6*x.4,1+ 3.6*x.4,2+ 4.5*x.4,3+ 8.2*x.4,4+ 8.9*x.4,5)
#     +127*( 1.5*x.5,1+ 3.1*x.5,2+ 2.1*x.5,3+ 7.9*x.5,4+ 8.8*x.5,5)
#     +129*( 4.2*x.6,1+ 4.9*x.6,2+ 6.5*x.6,3+ 7.7*x.6,4+ 6.1*x.6,5)
#     +111*( 4.8*x.7,1+ 6.2*x.7,2+ 9.9*x.7,3+ 6.2*x.7,4+ 5.7*x.7,5) 
#     +110*( 5.4*x.8,1+ 6.0*x.8,2+ 5.2*x.8,3+ 7.6*x.8,4+ 4.9*x.8,5)
#     +130*( 3.1*x.9,1+ 4.1*x.9,2+ 6.6*x.9,3+ 7.5*x.9,4+ 7.2*x.9,5)
#     +135*(3.2*x.10,1+6.5*x.10,2+7.1*x.10,3+6.0*x.10,4+8.3*x.10,5))
# The indices of the variables are replaced by the numbers 1-50, so 
# that indices 1-5 are for sector 1 for each disposal site, 6-10 for
# site 2 and so on.

# We set the functional constraints 1-10 so that each sector 
# belongs to one site.
#      x.1 +  x.2 +  x.3 +  x.4 +  x.5 = 1
#      x.6 +  x.7 +  x.8 +  x.9 + x.10 = 1
#     x.11 + x.12 + x.13 + x.14 + x.15 = 1
#     x.16 + x.17 + x.18 + x.19 + x.20 = 1
#     x.21 + x.22 + x.23 + x.24 + x.25 = 1
#     x.26 + x.27 + x.28 + x.29 + x.30 = 1
#     x.31 + x.32 + x.33 + x.34 + x.35 = 1
#     x.36 + x.37 + x.38 + x.39 + x.40 = 1
#     x.41 + x.42 + x.43 + x.44 + x.45 = 1
#     x.46 + x.47 + x.48 + x.49 + x.50 = 1

# Furthermore, constraints 11-15 are the disposal site capacities 
# as in table in exercise

#     153*x.1 + 152 *x.6 + 154*x.11 + 138*x.16 + 127*x.21 +
#      129*x.26 + 111*x.31 + 110*x.36 + 130*x.41 + 135*x.46 <= 350
#     153*x.2 + 152 *x.7 + 154*x.12 + 138*x.17 + 127*x.22 +
#      129*x.27 + 111*x.32 + 110*x.37 + 130*x.42 + 135*x.47 <= 250
#     153*x.3 + 152 *x.8 + 154*x.13 + 138*x.18 + 127*x.23 +
#      129*x.28 + 111*x.33 + 110*x.38 + 130*x.43 + 135*x.48 <= 500
#     153*x.4 + 152 *x.9 + 154*x.14 + 138*x.19 + 127*x.24 +
#      129*x.29 + 111*x.34 + 110*x.39 + 130*x.44 + 135*x.49 <= 400
#     153*x.5 + 152*x.10 + 154*x.15 + 138*x.20 + 127*x.25 + 
#      129*x.30 + 111*x.35 + 110*x.40 + 130*x.45 + 135*x.50 <= 200

# Lastly the non-negativity constraints 16-65

#     x.1,...,x.50 >= 0

### ---------------PROGRAM OUTPUT-------------------

# Objective function
Z    <- c(c(3.4,1.4,4.9,7.4,9.3)*153,
          c(2.4,2.1,8.3,9.1,8.8)*152,
          c(1.4,2.9,3.7,9.4,8.6)*154,
          c(2.6,3.6,4.5,8.2,8.9)*138,
          c(1.5,3.1,2.1,7.9,8.8)*127,
          c(4.2,4.9,6.5,7.7,6.1)*129,
          c(4.8,6.2,9.9,6.2,5.7)*111,
          c(5.4,6.0,5.2,7.6,4.9)*110,
          c(3.1,4.1,6.6,7.5,7.2)*130,
          c(3.2,6.5,7.1,6.0,8.3)*135) * 35

# Functionality constraints
f.1  <- c(1,1,1,1,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.1  <- c(1)                               
f.2  <- c(0,0,0,0,0,1,1,1,1,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.2  <- c(1)
f.3  <- c(0,0,0,0,0,0,0,0,0,0,
          1,1,1,1,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.3  <- c(1)
f.4  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,1,1,1,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0) 
g.4  <- c(1)
f.5  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,1,1,1,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)       
g.5  <- c(1)
f.6  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,1,1,1,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.6  <- c(1)                               
f.7  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,1,1,1,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.7  <- c(1)
f.8  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,1,1,1,1,
          0,0,0,0,0,0,0,0,0,0)
g.8  <- c(1)
f.9  <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,1,1,1,1,0,0,0,0,0) 
g.9  <- c(1)
f.10 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,1,1,1,1)       
g.10 <- c(1)

# Capacity constraints

f.11 <- c(153,0,0,0,0,152,0,0,0,0,
          154,0,0,0,0,138,0,0,0,0,
          127,0,0,0,0,129,0,0,0,0,
          111,0,0,0,0,110,0,0,0,0,
          130,0,0,0,0,135,0,0,0,0)
g.11 <- c(350)
f.12 <- c(0,153,0,0,0,0,152,0,0,0,
          0,154,0,0,0,0,138,0,0,0,
          0,127,0,0,0,0,129,0,0,0,
          0,111,0,0,0,0,110,0,0,0,
          0,130,0,0,0,0,135,0,0,0)
g.12 <- c(250)
f.13 <- c(0,0,153,0,0,0,0,152,0,0,
          0,0,154,0,0,0,0,138,0,0,
          0,0,127,0,0,0,0,129,0,0,
          0,0,111,0,0,0,0,110,0,0,
          0,0,130,0,0,0,0,135,0,0)
g.13 <- c(500)
f.14 <- c(0,0,0,153,0,0,0,0,152,0,
          0,0,0,154,0,0,0,0,138,0,
          0,0,0,127,0,0,0,0,129,0,
          0,0,0,111,0,0,0,0,110,0,
          0,0,0,130,0,0,0,0,135,0)
g.14 <- c(400)
f.15 <- c(0,0,0,0,153,0,0,0,0,152,
          0,0,0,0,154,0,0,0,0,138,
          0,0,0,0,127,0,0,0,0,129,
          0,0,0,0,111,0,0,0,0,110,
          0,0,0,0,130,0,0,0,0,135)
g.15 <- c(200)

# Non-negativity constraints

f.16  <- c(1,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0)  # x.1 >= 0
g.16  <- c(0)                                        
f.17  <- c(0,1,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0)  # x.2 >= 0                       
g.17  <- c(0)
f.18  <- c(0,0,1,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0)  # x.3 >= 0 and so on..
g.18  <- c(0)
f.19  <- c(0,0,0,1,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0)        
g.19  <- c(0)
f.20 <- c(0,0,0,0,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.20 <- c(0)
f.21 <- c(0,0,0,0,0,1,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.21 <- c(0)
f.22 <- c(0,0,0,0,0,0,1,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.22 <- c(0)
f.23 <- c(0,0,0,0,0,0,0,1,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.23 <- c(0)
f.24 <- c(0,0,0,0,0,0,0,0,1,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.24 <- c(0)
f.25 <- c(0,0,0,0,0,0,0,0,0,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.25 <- c(0)
f.26 <- c(0,0,0,0,0,0,0,0,0,0,
          1,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.26 <- c(0)
f.27 <- c(0,0,0,0,0,0,0,0,0,0,
          0,1,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.27 <- c(0)
f.28 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,1,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.28 <- c(0)
f.29 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,1,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.29 <- c(0)
f.30 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.30 <- c(0)
f.31 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.31 <- c(0)
f.32 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,1,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.32 <- c(0)
f.33 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,1,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.33 <- c(0)
f.34 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,1,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.34 <- c(0)
f.35 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.35 <- c(0)
f.36 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.36 <- c(0)
f.37 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,1,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.37 <- c(0)
f.38 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,1,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.38 <- c(0)
f.39 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,1,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.39 <- c(0)
f.40 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.40 <- c(0)
f.41 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.41 <- c(0)
f.42 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,1,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.42 <- c(0)
f.43 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,1,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.43 <- c(0)
f.44 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,1,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.44 <- c(0)
f.45 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,1,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.45 <- c(0)
f.46 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.46 <- c(0)
f.47 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,1,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.47 <- c(0)
f.48 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,1,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.48 <- c(0)
f.49 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,1,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.49 <- c(0)
f.50 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,1,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.50 <- c(0)
f.51 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.51 <- c(0)
f.52 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,1,0,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.52 <- c(0)
f.53 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,1,0,0,
          0,0,0,0,0,0,0,0,0,0)
g.53 <- c(0)
f.54 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,1,0,
          0,0,0,0,0,0,0,0,0,0)
g.54 <- c(0)
f.55 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,1,
          0,0,0,0,0,0,0,0,0,0)
g.55 <- c(0)
f.56 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          1,0,0,0,0,0,0,0,0,0)
g.56 <- c(0)
f.57 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,1,0,0,0,0,0,0,0,0)
g.57 <- c(0)
f.58 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,1,0,0,0,0,0,0,0)
g.58 <- c(0)
f.59 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,1,0,0,0,0,0,0)
g.59 <- c(0)
f.60 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,1,0,0,0,0,0)
g.60 <- c(0)
f.61 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,1,0,0,0,0)
g.61 <- c(0)
f.62 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,1,0,0,0)
g.62 <- c(0)
f.63 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,1,0,0)
g.63 <- c(0)
f.64 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,1,0)
g.64 <- c(0)
f.65 <- c(0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,0,
          0,0,0,0,0,0,0,0,0,1)
g.65 <- c(0)

# We now build the input into our simplex function.

# Noting that variables 1-50 should be integers
int <- 1:50

# For our constraints:

# Manually the number of constraints are typed in
c.l <- 5  # For less-than-or-equal-to constraints
c.m <- 50 # For more-than-or-equal-to constraints
c.e <- 10 # For equal-to constraints

n  <- length(Z)   # amount of x-variables.

A.l <- matrix(c(f.11,f.12,f.13,f.14,f.15)
              ,nrow=c.l,ncol=n, byrow=TRUE)
b.l <- matrix(c(g.11,g.12,g.13,g.14,g.15)
              ,nrow=c.l,ncol=1, byrow=TRUE)
A.m <- matrix(c(f.16,f.17,f.18,f.19,f.20,
                f.21,f.22,f.23,f.24,f.25,
                f.26,f.27,f.28,f.29,f.30,
                f.31,f.32,f.33,f.34,f.35,
                f.36,f.37,f.38,f.39,f.40,
                f.41,f.42,f.43,f.44,f.45,
                f.46,f.47,f.48,f.49,f.50,
                f.51,f.52,f.53,f.54,f.55,
                f.56,f.57,f.58,f.59,f.60,
                f.61,f.62,f.63,f.64,f.65)
              ,nrow=c.m,ncol=n, byrow=TRUE)
b.m <- matrix(c(g.16,g.17,g.18,g.19,g.20,
                g.21,g.22,g.23,g.24,g.25,
                g.26,g.27,g.28,g.29,g.30,
                g.31,g.32,g.33,g.34,g.35,
                g.36,g.37,g.38,g.39,g.40,
                g.41,g.42,g.43,g.44,g.45,
                g.46,g.47,g.48,g.49,g.50,
                g.51,g.52,g.53,g.54,g.55,
                g.56,g.57,g.58,g.59,g.60,
                g.61,g.62,g.63,g.64,g.65)
              ,nrow=c.m,ncol=1, byrow=TRUE)
A.e <- matrix(c( f.1, f.2, f.3, f.4, f.5,
                 f.6, f.7, f.8, f.9,f.10)
              ,nrow=c.e,ncol=n, byrow=TRUE)
b.e <- matrix(c( g.1, g.2, g.3, g.4, g.5,
                 g.6, g.7, g.8, g.9,g.10)
              ,nrow=c.e,ncol=1,byrow=TRUE)

A <- rbind(A.l,A.m,A.e)
b <- rbind(b.l,b.m,b.e)

const.dir <- c(rep("<=",c.l),rep(">=",c.m),rep("=",c.e))

### ------------------CALCULATIONS-------------------


results <- lp (direction = "min", objective.in=Z, const.mat = A, 
               const.dir, const.rhs=b,
               int.vec = int, all.int=FALSE, all.bin=FALSE,
               num.bin.solns=1, use.rw=FALSE)

results$solution
costA <- results$objval
costA

### ------------------ PART B -------------------

# For Question B, we adapt the objective function, and add the 
# contamination removal capacity constraints.

# It is given that the removal per disposal site is as shown in
# following vector
r <- c(0.3,0.4,0.2,0.7,0.5)

Zb <- c(r*153,r*152,r*154,r*138,r*127,r*129,r*111,r*110,r*130,r*135)
Zb

c.l <- 10


f.66 <- c(153,0,0,0,0,152,0,0,0,0,
          154,0,0,0,0,138,0,0,0,0,
          127,0,0,0,0,129,0,0,0,0,
          111,0,0,0,0,110,0,0,0,0,
          130,0,0,0,0,135,0,0,0,0)*r[1]
g.66 <- c(350)*r[1]
f.67 <- c(0,153,0,0,0,0,152,0,0,0,
          0,154,0,0,0,0,138,0,0,0,
          0,127,0,0,0,0,129,0,0,0,
          0,111,0,0,0,0,110,0,0,0,
          0,130,0,0,0,0,135,0,0,0)*r[2]
g.67 <- c(250)*r[2]
f.68 <- c(0,0,153,0,0,0,0,152,0,0,
          0,0,154,0,0,0,0,138,0,0,
          0,0,127,0,0,0,0,129,0,0,
          0,0,111,0,0,0,0,110,0,0,
          0,0,130,0,0,0,0,135,0,0)*r[3]
g.68 <- c(500)*r[3]
f.69 <- c(0,0,0,153,0,0,0,0,152,0,
          0,0,0,154,0,0,0,0,138,0,
          0,0,0,127,0,0,0,0,129,0,
          0,0,0,111,0,0,0,0,110,0,
          0,0,0,130,0,0,0,0,135,0)*r[4]
g.69 <- c(400)*r[4]
f.70 <- c(0,0,0,0,153,0,0,0,0,152,
          0,0,0,0,154,0,0,0,0,138,
          0,0,0,0,127,0,0,0,0,129,
          0,0,0,0,111,0,0,0,0,110,
          0,0,0,0,130,0,0,0,0,135)*r[5]
g.70 <- c(200)*r[5]

A.l <- matrix(c(f.11,f.12,f.13,f.14,f.15
                ,f.66,f.67,f.68,f.69,f.70)
              ,nrow=c.l,ncol=n, byrow=TRUE)
b.l <- matrix(c(g.11,g.12,g.13,g.14,g.15
                ,g.66,g.67,g.68,g.69,g.70)
              ,nrow=c.l,ncol=1, byrow=TRUE)

A <- rbind(A.l,A.m,A.e)
b <- rbind(b.l,b.m,b.e)

const.dir <- c(rep("<=",c.l),rep(">=",c.m),rep("=",c.e))

# And calculate again.

resultsB <- lp (direction = "max", objective.in=Zb, const.mat = A, 
               const.dir, const.rhs=b,
               int.vec = int, all.int=FALSE, all.bin=FALSE,
               num.bin.solns=1, use.rw=FALSE)

resultsB$solution
resultsB$objval

# We multiply the solution vector with the cost vector from part A 
# to calculate cost
costB <- sum( 35 * resultsB$solution * c(c(3.4,1.4,4.9,7.4,9.3)*153,
                                         c(2.4,2.1,8.3,9.1,8.8)*152,
                                         c(1.4,2.9,3.7,9.4,8.6)*154,
                                         c(2.6,3.6,4.5,8.2,8.9)*138,
                                         c(1.5,3.1,2.1,7.9,8.8)*127,
                                         c(4.2,4.9,6.5,7.7,6.1)*129,
                                         c(4.8,6.2,9.9,6.2,5.7)*111,
                                         c(5.4,6.0,5.2,7.6,4.9)*110,
                                         c(3.1,4.1,6.6,7.5,7.2)*130,
                                         c(3.2,6.5,7.1,6.0,8.3)*135))
cat("The cost of following the maximal contamination removal 
    strategy is",costB
    ,"mu which is",(costB/costA - 1)*100
    ,"% more costly than following the minimal cost strategy.")

### ------------------ PART C -------------------

# For Question C, we adapt the objective function to have multiple 
# objectives which we make relative compared to the values given in
# parts A and B

# First let us set the weights of decreasing costs and maximal
# contaminant removal.
# Let us weigh them equally

w.1 <- 1 # for cost reduction
w.2 <- 1 # for contaminant removal

C <- 191450
R <- 592.7

Z.cost <- c((w.1*35*c(3.4,1.4,4.9,7.4,9.3))*153,
           (w.1*35*c(2.4,2.1,8.3,9.1,8.8))*152,
           (w.1*35*c(1.4,2.9,3.7,9.4,8.6))*154,
           (w.1*35*c(2.6,3.6,4.5,8.2,8.9))*138,
           (w.1*35*c(1.5,3.1,2.1,7.9,8.8))*127,
           (w.1*35*c(4.2,4.9,6.5,7.7,6.1))*129,
           (w.1*35*c(4.8,6.2,9.9,6.2,5.7))*111,
           (w.1*35*c(5.4,6.0,5.2,7.6,4.9))*110,
           (w.1*35*c(3.1,4.1,6.6,7.5,7.2))*130,
           (w.1*35*c(3.2,6.5,7.1,6.0,8.3))*135)

Z.cont <- c((r)*153,
            (r)*152,
            (r)*154,
            (r)*138,
            (r)*127,
            (r)*129,
            (r)*111,
            (r)*110,
            (r)*130,
            (r)*135) 

Zc   <- c(((w.1*(35*c(3.4,1.4,4.9,7.4,9.3)-C)/C)+(w.2*(R-r)/R))*153,
          ((w.1*(35*c(2.4,2.1,8.3,9.1,8.8)-C)/C)+(w.2*(R-r)/R))*152,
          ((w.1*(35*c(1.4,2.9,3.7,9.4,8.6)-C)/C)+(w.2*(R-r)/R))*154,
          ((w.1*(35*c(2.6,3.6,4.5,8.2,8.9)-C)/C)+(w.2*(R-r)/R))*138,
          ((w.1*(35*c(1.5,3.1,2.1,7.9,8.8)-C)/C)+(w.2*(R-r)/R))*127,
          ((w.1*(35*c(4.2,4.9,6.5,7.7,6.1)-C)/C)+(w.2*(R-r)/R))*129,
          ((w.1*(35*c(4.8,6.2,9.9,6.2,5.7)-C)/C)+(w.2*(R-r)/R))*111,
          ((w.1*(35*c(5.4,6.0,5.2,7.6,4.9)-C)/C)+(w.2*(R-r)/R))*110,
          ((w.1*(35*c(3.1,4.1,6.6,7.5,7.2)-C)/C)+(w.2*(R-r)/R))*130,
          ((w.1*(35*c(3.2,6.5,7.1,6.0,8.3)-C)/C)+(w.2*(R-r)/R))*135) 

resultsC <- lp (direction = "min", objective.in=Zc, const.mat = A, 
                const.dir, const.rhs=b,
                int.vec = int, all.int=FALSE, all.bin=FALSE,
                num.bin.solns=1, use.rw=FALSE)

resultsC$solution
resultsC$objval

costC <- sum( 35 * resultsC$solution * c(c(3.4,1.4,4.9,7.4,9.3)*153,
                                         c(2.4,2.1,8.3,9.1,8.8)*152,
                                         c(1.4,2.9,3.7,9.4,8.6)*154,
                                         c(2.6,3.6,4.5,8.2,8.9)*138,
                                         c(1.5,3.1,2.1,7.9,8.8)*127,
                                         c(4.2,4.9,6.5,7.7,6.1)*129,
                                         c(4.8,6.2,9.9,6.2,5.7)*111,
                                         c(5.4,6.0,5.2,7.6,4.9)*110,
                                         c(3.1,4.1,6.6,7.5,7.2)*130,
                                         c(3.2,6.5,7.1,6.0,8.3)*135))
costC <- sum(resultsC$solution * Z.cost)
contC <- sum(resultsC$solution * Z.cont)

cat("The cost of following the multiple objective strategy is",costC
    ,"mu which is",(costC/costA - 1)*100
    ,"% more costly than following the minimal cost strategy,")
cat("allowing",contC,"m3 of snow to be de-contaminated.")

# END
